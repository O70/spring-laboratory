<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="template :: app_template(~{::title}, ~{::div.content-wrapper}, ~{::script})">
<head>
    <title>Advertising</title>
</head>
<body>
    <div class="content-wrapper">
        <el-upload
            action="api/adverts"
            list-type="picture-card"
            multiple
            :headers="upload.headers"
            :file-list="upload.list">
            <i slot="default" class="el-icon-plus"></i>
            <div slot="file" slot-scope="{file}">
                <img class="el-upload-list__item-thumbnail" :src="file.url"/>
                <span class="el-upload-list__item-actions">
                    <span class="el-upload-list__item-preview" @click="handlePreview(file)">
                        <i class="el-icon-zoom-in"></i>
                    </span>
                    <span class="el-upload-list__item-delete" @click="handleRemove(file)">
                        <i class="el-icon-delete"></i>
                    </span>
                </span>
            </div>
        </el-upload>

        <el-dialog :visible.sync="dialog.visible">
            <img width="100%" :src="dialog.src"/>
        </el-dialog>
    </div>

    <script type="text/javascript">
        Factory.Vue.build({
            data() {
                return {
                    dialog: {
                        visible: false,
                        src: ''
                    },
                    upload: {
                        headers: {},
                        list: [
                            { id: 'id-b1', name: 'b1', url: '/assets/images/hbis/b1.jpg'},
                            { id: 'id-b2', name: 'b2', url: '/assets/images/hbis/b2.jpg'},
                            { id: 'id-b3', name: 'b3', url: '/assets/images/hbis/b3.jpg'},
                            { id: 'id-b4', name: 'b4', url: '/assets/images/hbis/b4.jpg'}
                        ]
                    }
                }
            },
            mounted() {
                const csrf = id => document.getElementById(id).getAttribute('content');
                this.$set(this.upload.headers, csrf('_csrf_header'), csrf('_csrf_token'));
            },
            methods: {
                handlePreview(file) {
                    console.log(file);
                    this.dialog.src = file.url;
                    this.dialog.visible = true;
                },
                handleRemove(file) {
                    console.log(file)
                }
            }
        });
    </script>
</body>
</html>
